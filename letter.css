:root{
  --paper-bg:#f7fbff;
  --rule-color:#d9eefc;
  --left-line:#7fb0ff;
  --hole:#0f0f14;
  --body-font: "Merriweather", serif;
  --accent-font: "Dancing Script", cursive;
  --ui-font: "Open Sans", system-ui, Arial, sans-serif;
  --type-speed: 22;
  --page-width:460px;
  --typed-max-height:420px;
  --primary-blue:#4f8cff;
  --muted-blue:#aed1ff;
}

/* Base */
html,body{height:100%; margin:0}
body{
  background: linear-gradient(180deg,#0f1117,#13141a);
  font-family:var(--ui-font);
  -webkit-font-smoothing:antialiased;
}

.stage{ position:relative; width:100%; height:100%; }

/* Center container: use viewport-centering so envelope/paper are exactly centered */
.center{
  position:relative;
  width:100%;
  height:100vh;
  display:block;
}

/* Both envelope and paper are absolutely centered */
.envelope, .paper {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  box-sizing:border-box;
  margin:0;
}

/* Envelope */
.envelope {
  width:360px;
  height:280px;
  transform: translate(-50%,-50%) scale(1);
  transform-origin:center;
  transition: transform 380ms cubic-bezier(.2,.9,.3,1), opacity 320ms;
  cursor:pointer;
  z-index:8;
}
.env-body{
  position:absolute; inset:0;
  background:linear-gradient(180deg,var(--muted-blue),var(--primary-blue));
  border-radius:12px;
  box-shadow: 0 14px 50px rgba(18,24,40,0.6), inset 0 -6px 18px rgba(255,255,255,0.06);
}
.env-flap{
  position:absolute; left:0; right:0; top:0; height:58%; transform-origin:top center;
  background:linear-gradient(180deg,#eaf6ff,#d9efff);
  border-top-left-radius:12px; border-top-right-radius:12px;
  z-index:10;
  box-shadow:0 8px 20px rgba(8,12,24,0.25);
  transition: transform 380ms cubic-bezier(.2,.85,.25,1);
}
.seal{
  position:absolute; left:50%; transform:translateX(-50%); bottom:18%;
  width:84px; height:54px; background:linear-gradient(180deg,var(--primary-blue), #2b6edb);
  border-radius:14px; display:flex; align-items:center; justify-content:center;
  z-index:11; box-shadow: 0 8px 24px rgba(11,20,48,0.28);
}
.envelope.open { opacity:0; transform: translate(-50%,-50%) scale(0.98); pointer-events:none; }

/* Paper (hidden until opened) */
.paper {
  width:640px;
  max-width:92vw;
  height:680px;
  max-height:86vh;
  background: var(--paper-bg);
  border-radius:12px;
  box-shadow: 0 28px 100px rgba(7,10,18,0.65);
  z-index:9;
  pointer-events:none;
  opacity:0;
  visibility:hidden;
  transform: translate(-50%,-50%) scale(0.98);
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 380ms, visibility 0s linear 380ms;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding:18px;
  box-sizing:border-box;
}
.paper.visible{
  opacity:1;
  visibility:visible;
  pointer-events:auto;
  transform: translate(-50%,-50%) scale(1);
  transition-delay:0s;
}

/* Notebook inner */
.paper-inner.notebook{
  position:relative;
  width:100%;
  height:100%;
  border-radius:8px;
  overflow:hidden;
  background: linear-gradient(180deg, rgba(255,255,255,0.995), rgba(250,253,255,0.995));
  padding:28px;
  box-sizing:border-box;
  display:flex;
  align-items:flex-start;
  justify-content:center;
}

/* spiral / ruled lines */
.spiral{ position:absolute; left:14px; top:20px; bottom:20px; width:48px;
  background: radial-gradient(circle at 10px 14px, var(--hole) 6px, transparent 7px);
  background-size: 48px 48px; opacity:0.98; pointer-events:none; }

/* Removed the left blue vertical line (was .paper-inner.notebook::before) */

/* ruled background (kept subtle horizontal rules) */
.paper-inner.notebook::after{
  content:"";
  position:absolute;
  inset:0;
  background-image: repeating-linear-gradient(to bottom, transparent 0px, transparent 22px, var(--rule-color) 23px, var(--rule-color) 23px);
  pointer-events:none;
  opacity:0.92;
}

/* content & pages */
.content{ position:relative; width:100%; height:100%; max-width:540px; display:flex; flex-direction:column; align-items:center; gap:12px; box-sizing:border-box; }
.pages{ width:var(--page-width); max-width:100%; height: calc(var(--typed-max-height) + 120px); display:block; position:relative; }

/* page panels */
.page-panel{ position:absolute; left:0; top:0; width:100%; box-sizing:border-box; padding: 18px 10px 8px 18px; background: transparent; border-radius:6px; transition: opacity 260ms, transform 260ms; }
.page-panel.hidden{ opacity:0; transform: translateX(6px) scale(0.998); pointer-events:none; }
.page-panel.active{ opacity:1; transform: translateX(0); pointer-events:auto; }

/* notebook column */
.notebook-column{ width:100%; font-family: var(--body-font); font-size:15px; line-height:1.6; color:#1b2a36; display:flex; flex-direction:column; gap:8px; min-height: calc(var(--typed-max-height)); max-height: calc(var(--typed-max-height)); overflow:hidden; box-sizing:border-box; padding-left:8px; }
.salutation,.signature{ font-family: var(--accent-font); color:#18497f; font-weight:700; }
.salutation{ margin-bottom:6px; font-size:19px; }
.signature{ margin-top:12px; font-size:20px; opacity:0; transition:opacity 300ms ease; }

/* typed text */
.typed-paragraphs{ width:100%; overflow:auto; white-space:pre-wrap; padding-right:6px; font-family: var(--body-font); color:#223; }
.typed-paragraphs p{ margin:0 0 10px 0; }

/* QR in lower-right corner of paper; shown only on last page */
.qr-inpage{
  position:absolute;
  right:22px;
  bottom:22px;
  width:160px;
  height:160px;
  border-radius:12px;
  overflow:hidden;
  background:#fff;
  box-shadow:0 12px 30px rgba(0,0,0,0.12);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:12;
}
.qr-inpage img{ width:100%; height:100%; object-fit:contain; display:block; }

/* controls */
.controls-row{ width:100%; display:flex; justify-content:center; gap:12px; align-items:center; margin-top:10px; }
.btn{ background:#fff; border:1px solid rgba(0,0,0,0.06); padding:8px 12px; border-radius:8px; cursor:pointer; box-shadow: 0 6px 18px rgba(0,0,0,0.04); }
.btn.primary{ background: linear-gradient(180deg,#7fb0ff,#4f8cff); color:white; border:none; }

/* responsive sizes */
@media (max-width:900px){ :root{ --page-width:360px; --typed-max-height:360px } .paper{ width:86vw; height:78vh; } .envelope{ width:320px; height:240px; } .qr-inpage{ width:140px; height:140px; right:16px; bottom:16px; } }
@media (max-width:600px){ :root{ --page-width:320px; --typed-max-height:320px } .envelope{ width:280px; height:200px; } .paper{ width:92vw; height:84vh; padding:12px; } .paper-inner.notebook{ padding:18px; } .salutation{ font-size:16px; } .qr-inpage{ width:120px; height:120px; right:12px; bottom:12px; } }
@media (max-width:420px){ :root{ --page-width:280px; --typed-max-height:300px } .envelope{ width:260px; height:190px; } .paper{ height:80vh; } .qr-inpage{ width:100px; height:100px; right:10px; bottom:10px; } }
